C# implementation of the Factory method